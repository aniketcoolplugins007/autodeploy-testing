- name: Send Plugin Check Log via Email
if: failure()  # only send when the job fails
uses: dawidd6/action-send-mail@v3
with:
  server_address: smtp.gmail.com
  server_port: 465
  secure: true
  username: ${{ secrets.MAIL_USERNAME }}
  password: "jebk dviy mqds jocv"
  to: rocef76932@wivstore.com
  from: CoolPlugins CI Bot <${{ secrets.MAIL_USERNAME }}>
  subject: "âŒ Plugin Check Failed for ${{ inputs.plugin-folder }}"
  html_body: |
      ğŸ‘‹ <strong>Hello CoolPlugins Team,</strong><br><br>
      The <strong>Plugin Check</strong> for plugin <strong>${{ inputs.plugin-folder }}</strong> has <strong>failed</strong> because of detected issues.<br><br>

      <h2>ğŸ“‹ Summary</h2>
      <ul>
      <li><strong>Repository:</strong> <code>${{ github.repository }}</code></li>
      <li><strong>Workflow Run:</strong> <a href='${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}'>View Logs</a></li>
      <li><strong>Checked Folder:</strong> <code>${{ inputs.plugin-folder }}</code></li>
      <li><strong>Detected:</strong> ğŸš¨ ${ERROR_COUNT} Errors | âš ï¸ ${WARNING_COUNT} Warnings</li>
      </ul><br>

      <h2>âš ï¸ Detected Issues / Errors</h2>
      ${{ steps.email_body.outputs.log_content }}<br>
      Best regards,<br><strong>ğŸ§  CoolPlugins CI Bot</strong>