name: Plugin Check + Deploy to WordPress.org

on:
  push:  # ğŸ‘ˆ triggers on ALL branches and commits
    branches:
      - "**" # runs on every branch (feature/, main, develop, etc.)

jobs:  # ğŸ‘ˆ THIS is the key you were missing

  # Step 1: Run Plugin Check
  plugin-check:
    name: Run WordPress Plugin Check (PCP)
    uses: CoolPluginsTeam/cool-plugins-ci/.github/workflows/plugin-check.yml@main
    with:
      plugin-folder: autodeploy-testing  # ğŸ‘ˆ replace with your actual plugin folder

  # Step 2: Deploy to WordPress.org (only if Plugin Check passes)
  deploy:
    name: Deploy to WordPress.org
    runs-on: ubuntu-latest
    needs: plugin-check
    if: success()
    steps:
      - name: Print success text
        run: echo "âœ… Plugin Check passed â€” deploying to WordPress.org"

  # Step 3: Print failure text (only if Plugin Check fails)
  failure:
    name: Print failure text
    runs-on: ubuntu-latest
    needs: plugin-check
    if: failure()
    steps:
      - name: Print failure text
        run: echo "âŒ Plugin Check failed. Please review the GitHub Actions log for details."
