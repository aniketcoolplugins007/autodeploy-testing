name: Plugin Check + Deploy to WordPress.org

on:
  push:
    tags:
      - "v*.*.*"

jobs:
  plugin-check:
    name: Run WordPress Plugin Check (PCP)
    uses: CoolPluginsTeam/cool-plugins-ci/.github/workflows/plugin-check.yml@main
    with:
      plugin-folder: autodeploy-testing

  deploy:
    name: Deploy to WordPress.org
    runs-on: ubuntu-latest
    needs: plugin-check
    if: success()
    steps:
      - name: Print success text
        run: echo "✅ Plugin Check passed — deploying to WordPress.org"

  failure:
    name: Print failure text
    runs-on: ubuntu-latest
    needs: plugin-check
    if: failure()
    steps:
      - name: Print failure text
        run: echo "❌ Plugin Check failed. Please review the GitHub Actions log for details."
